# Homework 2: Numerical Integration

## Overview

This repository contains the complete solution and analysis for Homework 2. The primary objective of this assignment is to explore, implement, and critically evaluate various numerical integration techniques. The problems are designed to provide a hands-on understanding of the trade-offs between different methods in terms of **accuracy**, **convergence speed**, and **numerical stability**.

The analysis spans from simple one-dimensional integrals to more complex multi-dimensional problems, culminating in a real-world application within a dynamic stochastic economic model.

The entire analysis is conducted in MATLAB. The code is structured to be reproducible, with solver scripts for each problem that generate all the figures and text-file reports located in the `results` folder.

## Repository Structure

The project is organized into the following directories to ensure clarity and separation of concerns:

-   **/solvers/**: This directory contains the main executable scripts for each problem.
    -   `problem1_solver.m`: Solves and analyzes the 1D integration problem.
    -   `problem2_solver.m`: Solves and analyzes the 2D integration problem, demonstrating the curse of dimensionality.
    -   `problem3_solver.m`: Tackles the integration within a dynamic economic model, highlighting issues of numerical stability.

-   **/methods/**: A collection of helper functions that implement the various numerical integration algorithms used across the three problems. This includes functions for Gauss-Chebyshev quadrature, Trapezoid and Simpson's rules, Monte Carlo integration, and others.

-   **/results/**: This directory houses all the output generated by the `solvers`. It is further subdivided by problem.
    -   `/problem1`, `/problem2`, `/problem3`: Each folder contains the generated `.txt` files with numerical results and comparisons, as well as `.png` figures visualizing convergence and accuracy. The summary analysis for Problem 3 is provided in a dedicated `.md` file.

-   `hw2.md`: The original markdown file containing the problem set description and tasks.

## Problem 1: Analysis of 1D Integration Methods

The first problem serves as a foundational exercise in comparing standard one-dimensional integration techniques.

### Approach and Execution

The `problem1_solver.m` script was developed to systematically address each part of the problem:
1.  **Analytical Benchmark**: First, the exact solution to the integral was computed using MATLAB's symbolic toolbox. This provides a "ground truth" against which all numerical approximations are compared.
2.  **Gauss-Chebyshev Quadrature**: This spectral method was implemented and its convergence was studied. The analysis shows that it achieves high accuracy with a relatively small number of nodes, reaching the error tolerance of `1e-3` with a polynomial of degree 41.
3.  **Compound Rules**: The classic Trapezoid and Simpson's rules were coded from scratch. A convergence analysis was performed by iteratively increasing the number of subintervals (`M`).
4.  **Comparison**: Finally, all custom-coded methods were compared against each other and against MATLAB's highly optimized built-in functions (`quad`, `integral`, `trapz`).

### Findings and Insights

The results, summarized in `results/problem1/p1d_final_comparison.txt`, clearly illustrate the **order of accuracy** for different methods.
- **Simpson's rule** demonstrated its superior convergence rate, requiring only **128** subperiods to reach the target accuracy.
- The **Trapezoid rule**, being a lower-order method, required a much finer grid of **1024** subperiods to achieve the same tolerance.
This finding provides a practical demonstration of how higher-order methods can significantly reduce computational cost for a given level of accuracy.



## Problem 2: 2D Integration and the Curse of Dimensionality

This problem extends the analysis to two dimensions, with the explicit goal of demonstrating the challenges posed by the "curse of dimensionality."

### Approach and Execution

The `problem2_solver.m` script evaluates three different methods for 2D integration:
1.  **2D Gauss-Chebyshev Quadrature**: A product-rule version of the 1D method was implemented.
2.  **2D Trapezoid Rule**: A 2D implementation of the Trapezoid rule was created.
3.  **Monte Carlo Integration**: A stochastic approach was implemented using 10,000 random sample points.

These methods were then compared against MATLAB's `dblquad` function for a range of grid sizes and polynomial degrees to analyze their convergence properties.

### Findings and Insights

The results showcase the breakdown of grid-based methods in higher dimensions, as expected.
- The results in `results/problem2/p2d_specific_comparison.txt` are stark. Both the **Gauss-Chebyshev** and **Trapezoid** rules, when used with a coarse grid (D=5 and M=4, respectively), produced enormous errors, rendering them useless for this problem.
- The convergence analysis, documented in `results/problem2/p2d_convergence_data.txt`, shows that the number of function evaluations for these grid-based methods grows exponentially (as `D²` or `M²`), making them computationally infeasible for achieving high accuracy in multiple dimensions.
- The **Monte Carlo** method, while not highly accurate (producing an error of ~12.8%), has a computational cost that scales linearly with the number of sample points, independent of dimension. This makes it a viable, if imprecise, option for very high-dimensional integrals where other methods fail completely.

## Problem 3: Integration in a Dynamic Economic Model

The final problem applies these integration techniques to a core challenge in computational economics: solving for the policy function in a stochastic dynamic growth model by iterating on the Euler equation.

### Approach and Execution

The `problem3_solver.m` script was designed to test the robustness of different integration schemes within a fixed-point iteration algorithm. The standard, stable Gauss-Hermite quadrature was replaced with several alternatives:
1.  **MATLAB's `quad` and `integral`**: These adaptive quadrature routines were substituted into the Euler equation.
2.  **Monte Carlo Integration**: A crude Monte Carlo method with a small number of nodes (10) was used.
3.  **Monomial Rules**: Two deterministic, non-product monomial rules were implemented and tested.

### Findings and Insights

This problem powerfully demonstrates that in the context of solving dynamic models, **numerical stability is paramount**, often trumping the theoretical accuracy of an integration method.
- The experiment with MATLAB's `quad` function failed. As seen in the results, the solver becomes unstable. This occurs because the integrand can become ill-behaved, causing adaptive methods, which refine the grid on the fly, to break down. The more modern `integral` function avoids crashing but converges to an economically meaningless result (near-zero capital stock).
- **Crude Monte Carlo** integration introduced so much stochastic error into the fixed-point iteration that the solver failed to converge on the correct policy function.
- The **Monomial Rules**, being deterministic and using a fixed set of nodes, proved to be both **robust and efficient**. They converged reliably to the correct, economically sound policy function in a reasonable number of iterations.

The final comparison in `results/problem3/p3d.md` concludes that for this class of economic problems, stable, fixed-node quadrature rules are overwhelmingly superior.

## Key Learnings and Takeaways

This assignment provided several critical, forward-thinking insights into the practical application of numerical methods:

1.  **No Silver Bullet**: There is no single "best" integration method. The optimal choice is highly context-dependent. For low-dimensional, smooth functions, high-order methods like Gauss-Chebyshev are excellent. For high-dimensional problems, Monte Carlo methods may be the only feasible option, despite their slow convergence.
2.  **The Curse of Dimensionality is Real**: The exponential growth in computational cost for grid-based methods is not just a theoretical concept. This assignment shows how quickly these methods become impractical as the dimensionality of a problem increases.
3.  **Stability First**: When solving iterative models, particularly in economics, the stability and robustness of a numerical method are often more important than its raw accuracy. Methods that introduce noise or are sensitive to ill-conditioned functions can easily prevent a model from converging. This underscores the importance of choosing methods like Monomial or Gaussian quadrature rules that are known for their stability in such contexts.
